<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{layout/base :: head(pageTitle='Analytics Dashboard')}"></head>

<body>
    <nav th:replace="~{layout/base :: nav}"></nav>

    <main class="container mt-4">
        <h1>Analytics Dashboard</h1>

        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Sales Metrics</h5>
                        <p th:if="${salesMetrics}" class="card-text">
                            <strong>Total Sales:</strong> <span th:text="${salesMetrics.totalSales()}">0</span><br>
                            <strong>Total Items Sold:</strong> <span
                                th:text="${salesMetrics.totalItemsSold()}">0</span><br>
                            <strong>Average Items per Sale:</strong> <span
                                th:text="${#numbers.formatDecimal(salesMetrics.averageItemsSoldPerSale(), 1, 2)}">0.00</span><br>
                            <strong>Conversion Rate:</strong> <span
                                th:text="${#numbers.formatDecimal(salesMetrics.conversionRate(), 1, 4)}">0.0000</span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Revenue Metrics</h5>
                        <p th:if="${revenueMetrics}" class="card-text">
                            <strong>Total Revenue:</strong> £<span
                                th:text="${#numbers.formatDecimal(revenueMetrics.totalRevenue(), 1, 2)}">0.00</span><br>
                            <strong>Average Order Value:</strong> £<span
                                th:text="${#numbers.formatDecimal(revenueMetrics.averageOrderValue(), 1, 2)}">0.00</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Order Statistics</h5>
                        <p th:if="${orderStatistics}" class="card-text">
                            <strong>Total Orders:</strong> <span th:text="${orderStatistics.totalOrders()}">0</span><br>
                            <strong>Total Order Quantity:</strong> <span
                                th:text="${orderStatistics.totalOrderQuantity()}">0</span><br>
                            <strong>Average Order Quantity:</strong> <span
                                th:text="${#numbers.formatDecimal(orderStatistics.averageOrderQuantity(), 1, 2)}">0.00</span><br>
                            <strong>Paid Orders:</strong> <span th:text="${orderStatistics.paidOrders()}">0</span><br>
                            <strong>Failed Orders:</strong> <span
                                th:text="${orderStatistics.failedOrders()}">0</span><br>
                            <strong>Success Rate:</strong> <span
                                th:text="${#numbers.formatDecimal(orderStatistics.successRate(), 1, 4)}">0.0000</span><br>
                            <strong>Orders by Status:</strong><br>
                            <span th:if="${orderStatistics.ordersByStatus()}">
                                &nbsp;&nbsp;Pending: <span
                                    th:text="${orderStatistics.ordersByStatus().pending()}">0</span><br>
                                &nbsp;&nbsp;Paid: <span
                                    th:text="${orderStatistics.ordersByStatus().paid()}">0</span><br>
                                &nbsp;&nbsp;Failed: <span
                                    th:text="${orderStatistics.ordersByStatus().failed()}">0</span><br>
                                &nbsp;&nbsp;Refunded: <span
                                    th:text="${orderStatistics.ordersByStatus().refunded()}">0</span><br>
                                &nbsp;&nbsp;Dispatched: <span
                                    th:text="${orderStatistics.ordersByStatus().dispatched()}">0</span><br>
                                &nbsp;&nbsp;Cancelled: <span
                                    th:text="${orderStatistics.ordersByStatus().cancelled()}">0</span>
                            </span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Top Products</h5>
                        <div
                            th:if="${productPerformance != null and !productPerformance.topProductsByQuantity().isEmpty()}">
                            <ul class="list-group">
                                <li th:each="product : ${productPerformance.topProductsByQuantity()}"
                                    class="list-group-item">
                                    <strong th:text="${product.productName()}">Product</strong> -
                                    <span th:text="${product.quantitySold()}">0</span> sold
                                </li>
                            </ul>
                        </div>
                        <div th:if="${productPerformance == null or productPerformance.topProductsByQuantity().isEmpty()}"
                            class="alert alert-info">
                            No product performance data available.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer th:replace="~{layout/base :: footer}"></footer>
    <script th:replace="~{layout/base :: scripts}"></script>
</body>

</html>
